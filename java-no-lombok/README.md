# Java without Lombok

Person validation using **FunctionalJava** and the **Checker Framework** on Java 25, without Lombok.

## Approach

This subproject is identical to `traditional-is-not-always-simpler` in functionality and dependencies, with one
difference: Lombok has been removed entirely. The boilerplate that `@Value` generated — constructor, getters, `equals`,
`hashCode`, `toString` — is written out by hand (or generated once by an IDE like IntelliJ IDEA).

The motivation is to evaluate whether Lombok's annotation-processing complexity is worth the lines it saves, given that
modern IDEs can generate the same code on demand.

### Validation logic

The validation logic is unchanged. FunctionalJava's `Validation.accumulate` with a `NonEmptyList` semigroup runs all
checks independently and collects every failure:

```java
public static Validation<NonEmptyList<@ErrorMsg String>, Person> of(@NonNull String name, int age) {
    var validatedName   = check(!name.isBlank(), NAME_EMPTY_OR_WHITESPACE_ERROR_MSG, name);
    var validatedMinAge = check(age >= 0,        NEGATIVE_AGE_ERROR_MSG,             age);
    var validatedMaxAge = check(age <= MAX_AGE,  MAX_AGE_ERROR_MSG,                  age);
    return validatedName.accumulate(
            nonEmptyListSemigroup(), validatedMinAge, validatedMaxAge,
            (n, a1, a2) -> new Person(n, a1));
}
```

### What changed from the Lombok version

`Person.java` grew from 32 lines to 62 lines. The added code is mechanical: a constructor, two getters, and the
standard `equals`/`hashCode`/`toString` triple. Notably, `equals` must accept `@Nullable Object` to satisfy the
Checker Framework's NullnessChecker — something Lombok handled silently via `@lombok.Generated` warning suppression.

### Build complexity

Removing Lombok simplified the build in two ways:

1. **No annotation processor wiring** — the four `compileOnly`/`annotationProcessor`/`testCompileOnly`/
   `testAnnotationProcessor` Lombok dependency lines are gone.
2. **No forked javac workaround** — Lombok uses `sun.misc.Unsafe` internally, which required `options.isFork = true`
   and `--sun-misc-unsafe-memory-access=allow` on JDK 24+. Without Lombok, javac runs in-process with no special flags.
3. **No `lombok.config`** — the 14-line configuration file for `addNullAnnotations`, `copyableAnnotations`, and
   `addLombokGeneratedAnnotation` is no longer needed.

The Checker Framework build machinery (the `compileQualifiers` bootstrap task, annotation processor classpath wiring,
Spotless) remains — that complexity is intrinsic to using custom SubtypingChecker qualifiers, not to Lombok.

## Pros

- **Same type safety as the Lombok version** — `@ErrorMsg` type aliases, nullness checking, and applicative error
  accumulation are all preserved.
- **Simpler build** — 105-line `build.gradle.kts` (down from 146), no `lombok.config`, no JVM flag workarounds.
- **No annotation-processor ordering issues** — Lombok and the Checker Framework require careful processor ordering
  and classpath configuration. Removing Lombok eliminates an entire class of build problems.
- **IDE-transparent** — the code is what it appears to be. No hidden generated methods, no need for a Lombok plugin
  in the IDE.
- **Easier debugging** — stack traces point to real source lines, not Lombok-generated bytecode.

## Cons

- **More boilerplate** — `Person.java` is nearly twice the size (62 vs 32 lines). Every data class needs its
  constructor, getters, `equals`, `hashCode`, and `toString` written or generated.
- **Drift risk** — IDE-generated `equals`/`hashCode` can fall out of sync when fields are added. Lombok keeps them
  automatically consistent.
- **Still complex build** — the Checker Framework's `compileQualifiers` task, annotation processor classpath wiring,
  and Spotless configuration remain. The build is simpler than the Lombok version, but far from simple.
- **FunctionalJava's API is verbose** — `Validation.accumulate` with explicit semigroup and arity-specific lambdas
  is heavier ceremony than Arrow's `zipOrAccumulate` or Cats' `.mapN`.

## Running

```bash
./gradlew test
```

## Key Dependencies

| Library             | Version         | Role                                        |
|---------------------|-----------------|---------------------------------------------|
| FunctionalJava      | 5.0             | `Validation`, `NonEmptyList`, `Semigroup`   |
| Checker Framework   | 3.53.1          | `@ErrorMsg` type alias via SubtypingChecker |
| Spotless + Palantir | 8.2.1 / 2.88.0  | Code formatting                             |
| TestNG + AssertJ    | 7.12.0 / 3.27.7 | Testing                                     |
